version: api.keploy.io/v1beta2
kind: Http
name: TestOperations_CreateVM
spec:
    metadata:
        name: Http
        operation: POST
        type: HTTP_CLIENT
    req:
        method: POST
        proto_major: 1
        proto_minor: 1
        url: https://prism-test.nutanix.com:9440/api/nutanix/v3/vms
        header:
            Accept: application/json
            Content-Type: application/json
            User-Agent: nutanix/v3
        body: |
            {"metadata":{"kind":"vm","spec_version":1},"spec":{"cluster_reference":{"kind":"cluster","uuid":"00061f7f-44f7-19dc-3be1-7cc25586ee44"},"description":"test-vm-description","name":"test-vm","resources":{"boot_config":{"boot_type":"UEFI"},"disk_list":[{"data_source_reference":{"kind":"image","uuid":"70cfd137-a8d9-4169-a5ac-cf9ad6ddb03a"},"disk_size_mib":8192}],"memory_size_mib":1024,"nic_list":[{"subnet_reference":{"kind":"subnet","uuid":"b2e46975-2cde-4a49-9dda-815eb4fcd679"}}],"num_threads_per_core":1,"num_sockets":1}}}
        body_type: utf-8
    resp:
        status_code: 202
        header:
            Content-Security-Policy: 'connect-src ''self'' wss: https://downloads.frame.nutanix.com https://downloads.frame.nutanix.us; default-src ''self'' https://*.nutanix.com; frame-ancestors ''self'' https://*.nutanix.com; frame-src ''self'' https://*.nutanix.com blob: data:; img-src ''self'' blob: data:; script-src ''self'' ''unsafe-inline'' ''unsafe-eval''; style-src ''self'' ''unsafe-inline'''
            Content-Type: application/json
            Date: Sat, 07 Jun 2025 18:23:51 GMT
            Server: envoy
            Set-Cookie: Expires=Sat, 07-Jun-2025 18:38:00 GMT;Path=/;Secure;HttpOnly;SameSite=Lax
            Strict-Transport-Security: max-age=8640000:includeSubdomains
            Vary: Origin, Accept-Encoding
            X-Content-Type-Options: nosniff
            X-Dns-Prefetch-Control: "off"
            X-Envoy-Upstream-Service-Time: "493"
            X-Frame-Options: SAMEORIGIN
            X-Ntnx-Env: pc
            X-Ntnx-Product: pc.2024.3.0.1
            X-Permitted-Cross-Domain-Policies: master-only
            X-Xss-Protection: 1; mode=block
        body: '{"metadata": {"use_categories_mapping": false, "kind": "vm", "spec_version": 0, "uuid": "bdbbad7a-a401-4f9a-a789-2b8406905b56"}, "api_version": "3.1", "spec": {"description": "test-vm-description", "resources": {"num_threads_per_core": 1, "memory_size_mib": 1024, "boot_config": {"boot_type": "UEFI"}, "disk_list": [{"data_source_reference": {"kind": "image", "uuid": "70cfd137-a8d9-4169-a5ac-cf9ad6ddb03a"}, "disk_size_mib": 8192}], "num_sockets": 1, "nic_list": [{"subnet_reference": {"kind": "subnet", "uuid": "b2e46975-2cde-4a49-9dda-815eb4fcd679"}}]}, "cluster_reference": {"kind": "cluster", "uuid": "00061f7f-44f7-19dc-3be1-7cc25586ee44"}, "name": "test-vm"}, "status": {"state": "PENDING", "execution_context": {"task_uuid": "e074cb94-1123-4dca-82b0-b842f019a825"}}}'
        body_type: utf-8
        status_message: ""
        proto_major: 0
        proto_minor: 0
    objects:
        - type: error
          data: H4sIAAAAAAAA/wEAAP//AAAAAAAAAAA=
